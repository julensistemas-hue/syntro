---
import BlogLayout from "../../layouts/BlogLayout.astro";
---

<BlogLayout
  title="Monitorización de contenedores Docker con Wazuh"
  description="Monitorización de contenedores Docker con Wazuh: Guía práctica para implementación empresarial en Wazuh"
  publishDate="2026-01-10"
  author="AI Security"
  readTime="8 min"
  tags={["Docker", "contenedores", "logs", "monitoring", "security", "Wazuh", "Ciberseguridad"]}
  canonical="https://aisecurity.es/blog/monitorizacion-de-contenedores-docker-con-wazuh">

<div>
<h2>Problema que resuelve</h2>
<p>La adopción masiva de Docker introduce nuevos desafíos de seguridad y visibilidad. Los contenedores son efímeros, generan logs distribuidos y las imágenes pueden contener vulnerabilidades conocidas. Sin una monitorización centralizada, es imposible detectar actividades maliciosas, fallos de configuración o el uso de componentes vulnerables en tiempo real, dejando la infraestructura expuesta.</p>

<h2>Caso de uso empresarial</h2>
<p>Una empresa de e-commerce migra su plataforma a microservicios en Docker. El equipo de seguridad necesita una solución única para monitorizar los logs de todos los contenedores, auditar la actividad del daemon de Docker y escanear automáticamente las imágenes en busca de vulnerabilidades antes de su despliegue en producción, cumpliendo con políticas de seguridad internas.</p>

<h2>Requisitos previos</h2>
<ul>
<li>Wazuh Manager 4.7 o superior</li>
<li>Agente Wazuh instalado en el host Docker</li>
<li>Acceso root/sudo en el host para configurar el agente</li>
<li>Docker y Docker Compose instalados</li>
<li>Permisos para que el usuario wazuh ejecute comandos Docker</li>
</ul>

<h2>Implementación paso a paso</h2>
<p>Paso 1 Configurar el agente para recopilar logs de Docker</p>
<pre><code># Agregar usuario wazuh al grupo docker
sudo usermod -aG docker wazuh

# Crear regla local para capturar logs de contenedores
sudo nano /var/ossec/etc/rules/local_rules.xml</code></pre>
<p>En el archivo, define reglas para eventos como la creación de un contenedor privilegiado o la ejecución de un shell. No incluyas el XML completo, solo menciona que debes agregar reglas con group "docker".</p>

<p>Paso 2 Habilitar el módulo de integración Docker en el agente</p>
<pre><code># Editar la configuración del agente
sudo nano /var/ossec/etc/ossec.conf</code></pre>
<p>Busca la sección "wodle" y agrega la configuración del módulo Docker. Especifica el intervalo de escaneo, por ejemplo, every 300s.</p>

<p>Paso 3 Configurar el módulo de Vulnerabilidades para escanear imágenes Docker</p>
<pre><code># Instalar dependencias para el escaneo
sudo apt-get install -y curl jq

# Probar la consulta a la API de Docker
sudo docker images --format "table {{.Repository}}"</code></pre>
<p>Luego, en la misma sección "wodle" del archivo ossec.conf, habilita el módulo "vulnerability-detector" y configura las fuentes de bases de datos de vulnerabilidades como NVD.</p>

<p>Paso 4 Desplegar un entorno de prueba con docker-compose</p>
<pre><code># Crear un docker-compose.yml de ejemplo
cat > docker-compose.yml << EOL
version: '3.8'
services:
  web:
    image: nginx:1.21
    ports:
      - "8080:80"
  app:
    image: vulnerable-app:latest
    environment:
      - DB_HOST=database
  database:
    image: mysql:5.7
EOL

# Iniciar los servicios
sudo docker-compose up -d

# Ver los logs de un contenedor específico
sudo docker-compose logs web</code></pre>

<h2>Ejemplo práctico</h2>
<p>Tras la configuración, Wazuh comenzará a generar alertas. Por ejemplo, si un desarrollador descarga y ejecuta una imagen de MySQL con una versión crítica conocida (CVE-2022-21344), el módulo de vulnerabilidades detectará la coincidencia y generará una alerta de nivel 8 en el dashboard de Wazuh, mostrando el ID de CVE, la imagen afectada y el host. Simultáneamente, si un contenedor es eliminado abruptamente, el log de ese evento será capturado y correlacionado, permitiendo investigar posibles actividades de limpieza de evidencias.</p>

<h2>Conclusión y próximos pasos</h2>
<p>La integración de Wazuh con Docker proporciona una capa de seguridad esencial para entornos contenedorizados, ofreciendo visibilidad total, detección de amenazas y gestión de vulnerabilidades en imágenes. Para escalar esta solución, se puede integrar con un registro de contenedores privado y automatizar la respuesta, como detener un contenedor que ejecute un proceso malicioso. <a href="/reunion">Solicita una consulta gratuita</a> para implementar esta solución en tu infraestructura y asegurar tu ciclo de vida de contenedores.</p>
</div>

  <hr />

  <p class="text-sm text-base-600">
    <strong>¿Necesitas implementar esta solución?</strong> <a href="/reunion">Solicita una consulta gratuita aquí</a>.
  </p>
</BlogLayout>
