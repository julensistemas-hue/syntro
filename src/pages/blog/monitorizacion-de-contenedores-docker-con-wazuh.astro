---
import BlogLayout from "../../layouts/BlogLayout.astro";
---

<BlogLayout
  title="Monitorización de contenedores Docker con Wazuh"
  description="Monitorización de contenedores Docker con Wazuh: Guía práctica para implementación empresarial en Wazuh"
  publishDate="2026-01-10"
  author="AI Security"
  readTime="8 min"
  tags={["Docker", "contenedores", "logs", "monitoring", "security", "Wazuh", "Ciberseguridad"]}
  canonical="https://aisecurity.es/blog/monitorizacion-de-contenedores-docker-con-wazuh">

<div>
<h2>Problema que resuelve</h2>
<p>La adopción masiva de Docker introduce nuevos desafíos de seguridad y visibilidad. Los contenedores son efímeros, se escalan dinámicamente y generan logs descentralizados. Sin una monitorización centralizada, es imposible detectar actividades maliciosas, vulnerabilidades en imágenes o configuraciones inseguras, dejando la infraestructura expuesta.</p>

<h2>Caso de uso empresarial</h2>
<p>Una empresa de e-commerce migra su plataforma a microservicios en Docker. Necesitan cumplir con PCI DSS, lo que requiere auditoría de logs, detección de accesos no autorizados y escaneo de vulnerabilidades en las imágenes de contenedor desplegadas en producción. Wazuh centraliza toda esta información.</p>

<h2>Requisitos previos</h2>
<ul>
<li>Wazuh Manager 4.7 o superior desplegado</li>
<li>Agente Wazuh instalado en el host Docker (Linux)</li>
<li>Docker y Docker Compose instalados en el host</li>
<li>Permisos de sudo para ejecutar comandos de administración</li>
</ul>

<h2>Implementación paso a paso</h2>
<p>Paso 1. Configurar el agente Wazuh para recoger logs de Docker</p>
<pre><code># Editar la configuración del agente
sudo nano /var/ossec/etc/ossec.conf</code></pre>
<p>En este archivo, dentro de la sección ossec_config, añade un bloque localfile para monitorizar el socket de Docker y otro para los logs de contenedores en formato json. Especifica la ruta /var/lib/docker/containers/*/*.log.</p>

<p>Paso 2. Habilitar la integración de Docker en el agente</p>
<pre><code># Editar la configuración de integraciones
sudo nano /var/ossec/etc/shared/docker.yaml</code></pre>
<p>Crea este archivo con una sección de integraciones. Define una integración de tipo docker que ejecute el comando 'docker ps' y otra de tipo vulnerability_detector configurada para escanear imágenes Docker.</p>

<p>Paso 3. Reiniciar el agente Wazuh</p>
<pre><code>sudo systemctl restart wazuh-agent
sudo tail -f /var/ossec/logs/ossec.log</code></pre>

<p>Paso 4. Desplegar un entorno de prueba con Docker Compose</p>
<p>Crea un archivo docker-compose.yml con 3 servicios. Un servicio web que use la imagen nginx, un servicio app que use una imagen node y un servicio db que use la imagen mysql. Asegúrate de definir volúmenes para persistencia de la base de datos.</p>
<pre><code># Levantar los servicios
sudo docker-compose up -d
# Verificar que están corriendo
sudo docker-compose ps</code></pre>

<h2>Ejemplo práctico</h2>
<p>Wazuh detecta automáticamente los nuevos contenedores. La integración de vulnerability_detector escaneará las imágenes nginx, node y mysql contra la base de datos de CVE. Si se encuentra una vulnerabilidad crítica (por ejemplo, CVE-2021-44228 en una versión antigua de Log4j en la app Node), Wazuh generará una alerta de nivel 12 en el dashboard, indicando el ID del CVE, la imagen afectada y el contenedor. Simultáneamente, si un atacante ejecuta un comando shell interactivo en el contenedor de la base de datos, Wazuh capturará este evento del log de Docker y activará una regerta de alerta por actividad sospechosa.</p>

<h2>Conclusión y próximos pasos</h2>
<p>Wazuh proporciona una capa de seguridad integral para entornos Docker, unificando la monitorización de logs, la detección de intrusiones y el escaneo proactivo de vulnerabilidades. Para escalar esta solución a un clúster Kubernetes o a un entorno de producción multi-host, se requiere configurar el agente en cada nodo y centralizar la gestión en el manager. <a href="/reunion">Solicita una consulta gratuita</a> para implementar esta solución.</p>
</div>

  <hr />

  <p class="text-sm text-base-600">
    <strong>¿Necesitas implementar esta solución?</strong> <a href="/reunion">Solicita una consulta gratuita aquí</a>.
  </p>
</BlogLayout>
