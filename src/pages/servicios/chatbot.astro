---
import BaseLayout from "../../layouts/BaseLayout.astro";
---

<BaseLayout>
  <section class="py-20 bg-base-25">
    <div class="max-w-7xl mx-auto px-8 md:px-12 lg:px-24">
      <!-- Hero Section -->
      <div class="text-center mb-16">
        <div class="inline-flex items-center gap-2 px-4 py-2 bg-accent-100 text-accent-700 rounded-full text-sm font-medium mb-6">
          <span class="text-2xl">ğŸ¤–</span>
          Chatbot Inteligente
        </div>
        <h1 class="text-4xl md:text-5xl font-bold text-base-900 mb-6">
          AtenciÃ³n al cliente <span class="text-accent-600">24/7 automatizada</span>
        </h1>
        <p class="text-xl text-base-600 max-w-3xl mx-auto mb-6">
          Transforma la experiencia de tus clientes con un chatbot inteligente que entiende,
          responde y resuelve consultas de manera natural, las 24 horas del dÃ­a.
        </p>
       
        <div class="inline-flex items-center gap-2 px-4 py-2 bg-green-50 text-green-800 rounded-lg text-sm font-medium">
          <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
          Prueba haciendo click en las preguntas de ejemplo
        </div>
      </div>

      <!-- Interactive Demo Section -->
      <div class="mb-16">
        <div class="max-w-4xl mx-auto bg-gradient-to-br from-base-900 to-base-800 rounded-2xl shadow-2xl overflow-hidden">
          <!-- Demo Header -->
          <div class="bg-base-800 px-6 py-4 border-b border-base-700">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                <span class="ml-4 text-base-300 text-sm font-medium">Chat de Soporte - Demo</span>
              </div>
              <div class="flex items-center gap-2 text-base-400 text-sm">
                <span class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
                Online
              </div>
            </div>
          </div>

          <!-- Chat Interface -->
          <div class="bg-gradient-to-br from-blue-600 to-purple-600 p-8">
            <div class="max-w-3xl mx-auto">
              <!-- Chat Screen -->
              <div class="rounded-3xl p-6 shadow-2xl" style="background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);">
                <!-- Chat Container -->
                <div class="min-h-[450px] max-h-[450px] overflow-y-auto mb-4" id="chat-container">
                  <!-- Welcome Message -->
                  <div class="flex items-start gap-3 mb-4">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold flex-shrink-0">
                      AI
                    </div>
                    <div class="bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl rounded-tl-none px-4 py-3 shadow-sm max-w-[80%]">
                      <p class="text-white text-sm">Â¡Hola! ğŸ‘‹ Soy el asistente virtual de TechStore. Â¿En quÃ© puedo ayudarte hoy?</p>
                      <p class="text-blue-100 text-sm mt-3 font-medium">Puedes preguntarme sobre:</p>
                    </div>
                  </div>

                  <!-- Quick Question Buttons -->
                  <div class="space-y-2 mb-4 ml-14">
                    <button class="quick-question w-full text-left px-4 py-3 bg-white border-2 border-purple-300 rounded-xl text-sm text-purple-600 font-medium hover:bg-purple-50 hover:border-purple-400 transition-all duration-200 shadow-md">
                      Necesito mi factura, mi DNI es 12345678A
                    </button>
                    <button class="quick-question w-full text-left px-4 py-3 bg-white border-2 border-purple-300 rounded-xl text-sm text-purple-600 font-medium hover:bg-purple-50 hover:border-purple-400 transition-all duration-200 shadow-md">
                      Â¿El portÃ¡til HP 15-dy tiene SSD?
                    </button>
                    <button class="quick-question w-full text-left px-4 py-3 bg-white border-2 border-purple-300 rounded-xl text-sm text-purple-600 font-medium hover:bg-purple-50 hover:border-purple-400 transition-all duration-200 shadow-md">
                      Â¿DÃ³nde estÃ¡ mi pedido #TS-2845?
                    </button>
                  </div>
                </div>

                <!-- Input Area -->
                <div class="pt-4 border-t border-purple-500/30">
                  <form id="demo-chat-form" class="flex gap-3">
                    <input
                      type="text"
                      id="demo-chat-input"
                      placeholder="Escribe tu mensaje..."
                      class="flex-1 px-4 py-3 border-2 border-purple-500/40 rounded-xl focus:outline-none focus:border-purple-500 text-white placeholder-base-400 transition-colors"
                      style="background: rgba(15, 23, 42, 0.5);"
                    />
                    <button
                      type="submit"
                      class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl"
                    >
                      Enviar
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </div>

          <!-- Info Panel -->
          <div class="bg-base-100 px-6 py-5">
            <p class="text-sm text-base-600 text-center font-medium max-w-2xl mx-auto">
              Esta es una demo interactiva. En producciÃ³n, el chatbot se entrena con tu base de conocimientos.
            </p>
          </div>
        </div>
      </div>

      <!-- Features Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
        <div class="bg-base-50 border-2 border-purple-300 rounded-xl p-6">
          <div class="w-12 h-12 bg-accent-100 rounded-lg flex items-center justify-center text-accent-600 text-xl mb-4">
            ğŸ’¬
          </div>
          <h3 class="text-lg font-semibold text-base-900 mb-3">Conversaciones Naturales</h3>
          <p class="text-base-600">
            Procesamiento de lenguaje natural avanzado que entiende el contexto y responde de manera humana.
          </p>
        </div>

        <div class="bg-base-50 border-2 border-purple-300 rounded-xl p-6">
          <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 text-xl mb-4">
            ğŸ”—
          </div>
          <h3 class="text-lg font-semibold text-base-900 mb-3">MÃºltiples Canales</h3>
          <p class="text-base-600">
            IntegraciÃ³n con WhatsApp, Telegram, Facebook Messenger, web y mÃ¡s plataformas.
          </p>
        </div>

        <div class="bg-base-50 border-2 border-purple-300 rounded-xl p-6">
          <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center text-green-600 text-xl mb-4">
            ğŸ§ 
          </div>
          <h3 class="text-lg font-semibold text-base-900 mb-3">Aprendizaje Continuo</h3>
          <p class="text-base-600">
            El chatbot mejora constantemente aprendiendo de cada conversaciÃ³n y feedback.
          </p>
        </div>

        <div class="bg-base-50 border-2 border-purple-300 rounded-xl p-6">
          <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600 text-xl mb-4">
            ğŸ‘¤
          </div>
          <h3 class="text-lg font-semibold text-base-900 mb-3">Escalado Inteligente</h3>
          <p class="text-base-600">
            Deriva automÃ¡ticamente consultas complejas a agentes humanos cuando es necesario.
          </p>
        </div>

        <div class="bg-base-50 border-2 border-purple-300 rounded-xl p-6">
          <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center text-orange-600 text-xl mb-4">
            ğŸ“Š
          </div>
          <h3 class="text-lg font-semibold text-base-900 mb-3">Analytics Avanzados</h3>
          <p class="text-base-600">
            Dashboard completo con mÃ©tricas de satisfacciÃ³n, resoluciÃ³n y rendimiento.
          </p>
        </div>

        <div class="bg-base-50 border-2 border-purple-300 rounded-xl p-6">
          <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center text-red-600 text-xl mb-4">
            ğŸ”’
          </div>
          <h3 class="text-lg font-semibold text-base-900 mb-3">Seguridad Total</h3>
          <p class="text-base-600">
            Cumplimiento GDPR, encriptaciÃ³n end-to-end y protecciÃ³n de datos sensibles.
          </p>
        </div>
      </div>

      <!-- Integration Section -->
      <div class="bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl p-8 md:p-12 text-white mb-16">
        <h2 class="text-3xl font-bold mb-6 text-center">Integraciones y Conectividad</h2>
        <p class="text-center text-lg opacity-90 mb-8 max-w-3xl mx-auto">
          El chatbot se conecta en tiempo real con tus sistemas existentes para ofrecer respuestas precisas y actualizadas
        </p>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="bg-base-50/10 backdrop-blur-sm rounded-xl p-6">
            <div class="text-4xl mb-3">ğŸ—„ï¸</div>
            <h3 class="text-xl font-semibold mb-3">Base de Datos de Clientes</h3>
            <ul class="space-y-2 text-sm opacity-90">
              <li>â€¢ Consulta de informaciÃ³n del cliente</li>
              <li>â€¢ HistÃ³rico de compras y pedidos</li>
              <li>â€¢ Preferencias y configuraciÃ³n</li>
              <li>â€¢ Datos de contacto actualizados</li>
            </ul>
          </div>

          <div class="bg-base-50/10 backdrop-blur-sm rounded-xl p-6">
            <div class="text-4xl mb-3">ğŸ”Œ</div>
            <h3 class="text-xl font-semibold mb-3">APIs de Sistemas Externos</h3>
            <ul class="space-y-2 text-sm opacity-90">
              <li>â€¢ ERP (SAP, Odoo, Microsoft Dynamics)</li>
              <li>â€¢ CRM (Salesforce, HubSpot, Zoho)</li>
              <li>â€¢ Plataformas de envÃ­o y logÃ­stica</li>
              <li>â€¢ Pasarelas de pago</li>
            </ul>
          </div>

          <div class="bg-base-50/10 backdrop-blur-sm rounded-xl p-6">
            <div class="text-4xl mb-3">ğŸ“š</div>
            <h3 class="text-xl font-semibold mb-3">MÃºltiples Formatos de Datos</h3>
            <ul class="space-y-2 text-sm opacity-90">
              <li>â€¢ Documentos PDF, Word, Excel</li>
              <li>â€¢ Bases de datos SQL y NoSQL</li>
              <li>â€¢ APIs REST y GraphQL</li>
              <li>â€¢ Archivos CSV, JSON, XML</li>
            </ul>
          </div>
        </div>

        <div class="mt-8 text-center">
          <p class="text-sm opacity-75">
            âš¡ SincronizaciÃ³n en tiempo real â€¢ ğŸ”’ Conexiones seguras y encriptadas â€¢ ğŸ”„ Actualizaciones automÃ¡ticas
          </p>
        </div>
      </div>

      <!-- CTA Section -->
      <div class="text-center">
        <h2 class="text-3xl font-bold text-base-900 mb-6">
          Â¿Listo para automatizar tu atenciÃ³n al cliente?
        </h2>
        <p class="text-xl text-base-600 mb-8 max-w-2xl mx-auto">
          Programa una demostraciÃ³n gratuita y descubre cÃ³mo nuestro chatbot puede transformar
          la experiencia de tus clientes.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a
            href="/reunion"
            style="color: rgb(0, 0, 0);"
            class="inline-flex items-center justify-center px-8 py-4 text-lg font-semibold text-white bg-accent-600 hover:bg-accent-700 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200"
          >
            Solicitar Demo Gratuita
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.955 8.955 0 01-4.126-.98L3 20l1.98-5.874A8.955 8.955 0 013 12c0-4.418 3.582-8 8-8s8 3.582 8 8z"></path>
            </svg>
          </a>
          <a
            href="/#servicios"
            class="inline-flex items-center justify-center px-8 py-4 text-lg font-semibold text-base-700 bg-base-100 hover:bg-base-200 rounded-xl border border-base-200 hover:border-accent-300 transition-all duration-200"
          >
            Ver Otros Servicios
          </a>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const chatForm = document.getElementById('demo-chat-form') as HTMLFormElement;
    const chatInput = document.getElementById('demo-chat-input') as HTMLInputElement;
    const chatContainer = document.getElementById('chat-container') as HTMLDivElement;

    if (!chatForm || !chatInput || !chatContainer) return;

    // Respuestas predefinidas del bot para tienda de electrÃ³nica
    const responses: Record<string, string> = {
      'factura': 'ğŸ” He encontrado tu informaciÃ³n en nuestra base de datos:\n\nğŸ‘¤ Cliente: MarÃ­a GarcÃ­a LÃ³pez\nğŸ“§ Email: maria.garcia@email.com\nğŸ“± TelÃ©fono: +34 612 345 678\n\nğŸ“„ Ãšltima factura:\nâ€¢ NÃºmero: FAC-2024-03456\nâ€¢ Fecha: 15/01/2025\nâ€¢ Importe: 899,99â‚¬\nâ€¢ Producto: PortÃ¡til HP Pavilion 15\n\nâœ… Te he enviado la factura por email.\nÂ¿Necesitas la factura de otro pedido?',
      'producto': 'ğŸ’» PortÃ¡til HP 15-dy - Especificaciones:\n\nâœ… Procesador: Intel Core i5-1235U (12Âª Gen)\nâœ… RAM: 16GB DDR4\nâœ… Almacenamiento: SSD 512GB NVMe\nâœ… Pantalla: 15.6" Full HD (1920x1080)\nâœ… GrÃ¡ficos: Intel Iris Xe\nâœ… BaterÃ­a: hasta 8 horas\n\nğŸ’° Precio: 699,99â‚¬\nğŸ“¦ Stock: Disponible (envÃ­o 24-48h)\nâ­ ValoraciÃ³n: 4.5/5 (127 opiniones)\n\nÂ¿Quieres que te ayude con la compra?',
      'pedido': 'ğŸ“¦ Estado de tu pedido #TS-2845:\n\nâœ… Confirmado: 20/01/2025 10:23h\nâœ… Preparado: 20/01/2025 16:45h\nâœ… Enviado: 21/01/2025 09:12h\nğŸšš En reparto: LlegarÃ¡ maÃ±ana 22/01 antes de las 14:00h\n\nğŸ“ DirecciÃ³n de entrega:\nCalle Mayor 123, 2ÂºB\n28013 Madrid\n\nğŸ”— Seguimiento: ES1234567890YZ\nğŸ‘¤ Transportista: SEUR\n\nÂ¿Necesitas cambiar algo del envÃ­o?',
      'default': 'Entiendo tu consulta. Puedo ayudarte con:\n\nğŸ“„ Consultar facturas (dime tu DNI)\nğŸ’» InformaciÃ³n de productos\nğŸ“¦ Estado de pedidos\nğŸ”„ Devoluciones y garantÃ­as\nğŸ’³ MÃ©todos de pago\n\nÂ¿En quÃ© mÃ¡s puedo ayudarte?'
    };

    function addMessage(text: string, isUser: boolean) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `flex items-start gap-3 mb-4 ${isUser ? 'flex-row-reverse' : ''}`;

      const avatar = document.createElement('div');
      if (isUser) {
        avatar.className = 'w-10 h-10 rounded-full bg-white flex items-center justify-center text-purple-600 font-bold flex-shrink-0 shadow-md';
        avatar.textContent = 'TÃš';
      } else {
        avatar.className = 'w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold flex-shrink-0';
        avatar.textContent = 'AI';
      }

      const bubble = document.createElement('div');
      bubble.className = `rounded-2xl px-4 py-3 shadow-md max-w-[80%] ${
        isUser
          ? 'bg-white text-purple-600 rounded-tr-none font-medium'
          : 'bg-gradient-to-br from-blue-600 to-purple-600 text-white rounded-tl-none'
      }`;
      bubble.style.whiteSpace = 'pre-wrap';
      bubble.innerHTML = text.replace(/\n/g, '<br>');

      messageDiv.appendChild(avatar);
      messageDiv.appendChild(bubble);
      chatContainer.appendChild(messageDiv);

      // Scroll to bottom
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function getBotResponse(userMessage: string): string {
      const message = userMessage.toLowerCase();

      if (message.includes('factura') || message.includes('dni') || message.includes('12345678')) {
        return responses['factura'];
      }
      if (message.includes('portÃ¡til') || message.includes('portatil') || message.includes('hp') || message.includes('ssd') || message.includes('especificaciones')) {
        return responses['producto'];
      }
      if (message.includes('pedido') || message.includes('ts-2845') || message.includes('envÃ­o') || message.includes('envio') || message.includes('dÃ³nde estÃ¡') || message.includes('donde esta')) {
        return responses['pedido'];
      }

      return responses['default'];
    }

    function simulateTyping() {
      const typingDiv = document.createElement('div');
      typingDiv.className = 'flex items-start gap-3 mb-4';
      typingDiv.id = 'typing-indicator';

      const avatar = document.createElement('div');
      avatar.className = 'w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold flex-shrink-0';
      avatar.textContent = 'AI';

      const bubble = document.createElement('div');
      bubble.className = 'bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl rounded-tl-none px-4 py-3 shadow-sm';
      bubble.innerHTML = '<span class="inline-flex gap-1"><span class="w-2 h-2 bg-white rounded-full animate-bounce"></span><span class="w-2 h-2 bg-white rounded-full animate-bounce" style="animation-delay: 0.1s"></span><span class="w-2 h-2 bg-white rounded-full animate-bounce" style="animation-delay: 0.2s"></span></span>';

      typingDiv.appendChild(avatar);
      typingDiv.appendChild(bubble);
      chatContainer.appendChild(typingDiv);
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function removeTyping() {
      const typingIndicator = document.getElementById('typing-indicator');
      if (typingIndicator) {
        typingIndicator.remove();
      }
    }

    function sendMessage(message: string) {
      // Add user message
      addMessage(message, true);
      chatInput.value = '';

      // Hide quick question buttons after first use
      const quickButtons = document.querySelector('.space-y-2.mb-4.ml-14');
      if (quickButtons) {
        quickButtons.classList.add('hidden');
      }

      // Show typing indicator
      simulateTyping();

      // Simulate bot response delay
      setTimeout(() => {
        removeTyping();
        const botResponse = getBotResponse(message);
        addMessage(botResponse, false);
      }, 1000 + Math.random() * 1000);
    }

    chatForm.addEventListener('submit', (e) => {
      e.preventDefault();

      const userMessage = chatInput.value.trim();
      if (!userMessage) return;

      sendMessage(userMessage);
    });

    // Quick question buttons
    const quickQuestionButtons = document.querySelectorAll('.quick-question');
    quickQuestionButtons.forEach(button => {
      button.addEventListener('click', () => {
        const question = button.textContent?.trim();
        if (question) {
          chatInput.value = question;
          sendMessage(question);
        }
      });
    });
  });
</script>