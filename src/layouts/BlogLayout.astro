---
import BaseHead from "../components/BaseHead.astro";
import Navigation from "../components/global/Navigation.astro";
import Footer from "../components/global/Footer.astro";
import { Font } from "astro:assets";
import Analytics from "@vercel/analytics/astro";
import SpeedInsights from "@vercel/speed-insights/astro";

interface Props {
  title: string;
  description: string;
  publishDate: string;
  author?: string;
  readTime?: string;
  tags?: string[];
  canonical?: string;
  ogImage?: string;
}

const {
  title,
  description,
  publishDate,
  author = "AI Security",
  readTime = "5 min",
  tags = [],
  canonical,
  ogImage = "https://aisecurity.es/og-image.png"
} = Astro.props;

const fullTitle = `${title} | Blog AI Security`;
---

<html
  lang="es"
  class="scroll-smooth selection:bg-accent-500 selection:text-white no-touchevents hydrated">
  <head>
    <BaseHead
      title={fullTitle}
      description={description}
      canonical={canonical}
      ogImage={ogImage}
    />
    <Font cssVariable="--font-sans" preload />
  </head>
  <body class="bg-base-50 flex flex-col min-h-svh">
    <Navigation />

    <main class="grow">
      <!-- Article Header -->
      <section class="py-16 bg-gradient-to-br from-accent-50 to-blue-50 border-b border-base-200">
        <div class="max-w-4xl mx-auto px-6 md:px-8">
          <!-- Breadcrumb -->
          <nav class="mb-6" aria-label="Breadcrumb">
            <ol class="flex items-center gap-2 text-sm text-base-600">
              <li><a href="/" class="hover:text-accent-600 transition-colors">Inicio</a></li>
              <li aria-hidden="true">→</li>
              <li><a href="/blog" class="hover:text-accent-600 transition-colors">Blog</a></li>
              <li aria-hidden="true">→</li>
              <li class="text-base-800 font-medium" aria-current="page">Artículo</li>
            </ol>
          </nav>

          <!-- Tags -->
          {tags.length > 0 && (
            <div class="flex flex-wrap gap-2 mb-4">
              {tags.map(tag => (
                <span class="px-3 py-1 bg-accent-100 text-accent-700 text-xs font-semibold rounded-full">
                  {tag}
                </span>
              ))}
            </div>
          )}

          <!-- Title -->
          <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-base-900 mb-4 leading-tight">
            {title}
          </h1>

          <!-- Description -->
          <p class="text-lg md:text-xl text-base-700 mb-6 leading-relaxed">
            {description}
          </p>

          <!-- Meta info -->
          <div class="flex flex-wrap items-center gap-4 text-sm text-base-600">
            <div class="flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg>
              <span>{author}</span>
            </div>
            <div class="flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
              </svg>
              <time datetime={publishDate}>{new Date(publishDate).toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' })}</time>
            </div>
            <div class="flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <span>{readTime} lectura</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Article Content -->
      <article class="py-12 md:py-16">
        <div class="max-w-4xl mx-auto px-6 md:px-8">
          <div class="prose prose-lg prose-base max-w-none
            prose-headings:font-bold prose-headings:text-base-900
            prose-h2:text-2xl prose-h2:mt-8 prose-h2:mb-4
            prose-h3:text-xl prose-h3:mt-6 prose-h3:mb-3
            prose-p:text-base-700 prose-p:leading-relaxed prose-p:mb-4
            prose-a:text-accent-600 prose-a:no-underline hover:prose-a:underline
            prose-strong:text-base-900 prose-strong:font-semibold
            prose-code:text-accent-600 prose-code:bg-accent-50 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:font-mono prose-code:before:content-none prose-code:after:content-none
            prose-pre:bg-base-800 prose-pre:text-base-50 prose-pre:rounded-xl prose-pre:border prose-pre:border-base-700
            prose-ul:my-4 prose-li:text-base-700 prose-li:my-2
            prose-ol:my-4
            prose-img:rounded-xl prose-img:shadow-lg prose-img:border prose-img:border-base-200">
            <slot />
          </div>
        </div>
      </article>

      <!-- Back to Blog -->
      <section class="py-8 border-t border-base-200 bg-base-50">
        <div class="max-w-4xl mx-auto px-6 md:px-8">
          <a
            href="/blog"
            class="inline-flex items-center gap-2 text-accent-600 hover:text-accent-700 font-medium transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Volver al blog
          </a>
        </div>
      </section>
    </main>

    <Footer />
    <Analytics />
    <SpeedInsights />
  </body>
</html>

<style>
  /* Mejoras adicionales para el contenido del artículo */
  article img {
    margin: 2rem auto;
  }

  article pre {
    overflow-x: auto;
  }

  article code {
    font-size: 0.9em;
  }
</style>
